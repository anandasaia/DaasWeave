
let savedRange: Range;

/**
 * get the current selection
 * @return {Selection}
 */
export function getSelection() : Selection
{
    try
    {
        return document.getSelection();
    }
    catch(e)
    {
        return null;
    }
}


/**
 * get the current selection
 */
export function saveSelection()
{
    savedRange = getRange();
}



/**
 * get the current selection
 */
export function restoreSelection()
{
    //  get the document selection object

    const selection = document.getSelection();

    //  clear it

    selection.removeAllRanges();

    //  re-add our saved range

    selection.addRange(savedRange);
}





/**
 * get the current selection range
 * @return {Range}
 */
export function getRange() : Range
{
    try
    {
        return getSelection().getRangeAt(0);
    }
    catch(e)
    {
        return null;
    }
}

