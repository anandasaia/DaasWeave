"use strict";

Object.defineProperty(exports, "__esModule", { value: true });
var lodash_1 = require("lodash");
var Constants_1 = require("../../constants/Constants");
var Find_1 = require("../../utils/dom/element/Find");
var Observables_1 = require("../../state/Observables");
var ColourMixer_1 = require("../../colour/ColourMixer");
/**
 * create and populate one or more colour-swatches to display the current colour
 * @param options
 */
function createColourSwatches(options) {
  //  add listeners for each swatch
  lodash_1.toArray(Find_1.findByRolesWithin(options.elements.selector, Constants_1.pickMeConstants.elements.SWATCH)).forEach(function (element) {
    return addListeners(element, options);
  });
}
exports.createColourSwatches = createColourSwatches;
/**
 * add listeners to the swatch
 * @param swatch
 * @param options
 */
function addListeners(swatch, options) {
  Observables_1.activeID.takeUntil(options.destroy).filter(function (id) {
    return options.id === id;
  }).subscribe(function (id) {
    return activateSwatch(swatch);
  });
}
/**
 * activate the field; start listening for relevant events
 * @param swatch
 */
function activateSwatch(swatch) {
  //  subscribe to hue updates, stopping when the active id changes
  ColourMixer_1.autoObservableHex.takeUntil(Observables_1.activeID).subscribe(function (hex) {
    return swatch.style.setProperty('background-color', hex);
  });
}